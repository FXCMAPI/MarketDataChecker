'use strict';
let ASubscriptionInstrumentCommandFactory = require('./ASubscriptionInstrumentCommandFactory.js');
let PriceFeedCommandDescriptorBuilder = require('./PriceFeedCommandDescriptorBuilder.js');
let MessageType = require('./MessageType.js');
let exception = require('@gehtsoft/LuaxStdlib-node').exception;
class SubscriptionInstrumentCommandFactory extends ASubscriptionInstrumentCommandFactory {
    createCommandByRequest(subscriptionInstrumentRequest) {
        let command, messageType;
        command = null;
        messageType = subscriptionInstrumentRequest.getMessageType();
        if (messageType == MessageType.PriceFeed) {
            command = this.createPriceFeedCommand(subscriptionInstrumentRequest, PriceFeedCommandDescriptorBuilder.SUBSCRIBE);
        } else if (messageType == MessageType.InstrumentSubscribingStatus) {
            command = this.createInstrumentSubscribingStatusCommand(subscriptionInstrumentRequest, true);
        } else if (messageType == MessageType.GetInstruments) {
            command = this.commandFactory.createGetAllInstrumentsCommand(subscriptionInstrumentRequest.getOfferIds(), this.messageExecutor, this.sessionProvider.getSession(), this.messageFactory, subscriptionInstrumentRequest.getRequestNumber());
        } else if (messageType == MessageType.GetOffers) {
            command = this.commandFactory.createGetAllOffersCommand(subscriptionInstrumentRequest.getOfferIds(), this.messageExecutor, this.sessionProvider.getSession(), this.messageFactory, subscriptionInstrumentRequest.getRequestNumber());
        }         else {
            throw exception.create(0, "Command for " + messageType + " is not supported");
        }
        return command;
    }
    static create(commandFactory, messageExecutor, messageFactory, sessionProvider, instrumentsStorage) {
        let result;
        result = new SubscriptionInstrumentCommandFactory();
        result.commandFactory = commandFactory;
        result.messageExecutor = messageExecutor;
        result.sessionProvider = sessionProvider;
        result.messageFactory = messageFactory;
        result.instrumentsStorage = instrumentsStorage;
        return result;
    }
}
module.exports = SubscriptionInstrumentCommandFactory
