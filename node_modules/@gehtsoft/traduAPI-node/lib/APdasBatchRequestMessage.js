'use strict';
let APdasRequestMessage = require('./APdasRequestMessage.js');
let PdasMessageType = require('./PdasMessageType.js');
let PdasMessageFieldTag = require('./PdasMessageFieldTag.js');
let TimeStamp = require('./TimeStamp.js');
class APdasBatchRequestMessage extends APdasRequestMessage {
    static createBatchMessage(contingencyType, factory, tradingSession, transactTime, requestId) {
        return APdasBatchRequestMessage.createBatchMessageInternal(contingencyType, factory, tradingSession, transactTime, requestId, tradingSession.getTradingTerminal(), PdasMessageType.FXCM_REQUEST);
    }
    static createMdtBatchMessage(contingencyType, factory, terminal, transactTime, requestId) {
        return APdasBatchRequestMessage.createBatchMessageInternal(contingencyType, factory, null, transactTime, requestId, terminal, PdasMessageType.PRICE_FEED_MESSAGE);
    }
    static createBatchMessageInternal(contingencyType, factory, tradingSession, transactTime, requestId, terminal, refMsgType) {
        let pdasMessage, timeStamp;
        pdasMessage = factory.createMessage(PdasMessageType.FXCM_BATCH_REQUEST);
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.TEST_REQUEST_ID, requestId));
        if (contingencyType > 0) {
            pdasMessage.addChild(factory.createIntField(PdasMessageFieldTag.CONTINGENCY_GROUP_TYPE, contingencyType));
        }
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.MD_REQ_ID, requestId));
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.TRADING_SESSION_ID, terminal.getId()));
        if (tradingSession != null) {
            APdasRequestMessage.addSaltedRequestIdIfRequired(tradingSession, requestId, pdasMessage, factory);
        }
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.MSG_TYPE, PdasMessageType.FXCM_BATCH_REQUEST));
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.REF_MSG_TYPE, refMsgType));
        timeStamp = TimeStamp.create(transactTime);
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.TRANSACT_TIME, timeStamp.getTimeStampString()));
        pdasMessage.addChild(factory.createStringField(PdasMessageFieldTag.TRADING_SESSION_SUB_ID, terminal.getSubId()));
        return pdasMessage;
    }
}
module.exports = APdasBatchRequestMessage
