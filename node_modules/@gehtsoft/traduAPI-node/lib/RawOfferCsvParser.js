'use strict';
let csvParser = require('@gehtsoft/LuaxStdlib-node').csvParser;
let stdlib = require('@gehtsoft/LuaxStdlib-node').stdlib;
let RawOfferFromStringBuilder = require('./RawOfferFromStringBuilder.js');
let StringUtil = require('./StringUtil.js');
class RawOfferCsvParser {
    fieldParser;
    constructor() {
        this.fieldParser = new csvParser();
        this.fieldParser.valueSeparator = ";";
    }
    parse(line) {
        let parts, builder, rawOfferLine;
        if (line == null) {
            return null;
        }
        rawOfferLine = stdlib.trim(line);
        if (rawOfferLine == "0" || stdlib.len(rawOfferLine) == 0) {
            return null;
        }
        parts = this.fieldParser.splitLine(rawOfferLine);
        builder = new RawOfferFromStringBuilder();
        builder.setOfferId(parts[0]);
        builder.setBidTradable("N");
        builder.setAskTradable("N");
        builder.setDigits(parts[7]);
        builder.setPointSize(parts[8]);
        builder.setBid(parts[9]);
        builder.setAsk(parts[10]);
        if (parts.length > 11 && stdlib.len(parts[11]) > 0) {
            builder.setTradingStatus(parts[11]);
        }
        else {
            builder.setTradingStatus("");
        }
        if (parts.length > 13 && StringUtil.isRealNumber(parts[12]) && StringUtil.isRealNumber(parts[13])) {
            builder.setLow(parts[12]);
            builder.setHigh(parts[13]);
        }
        else {
            builder.setLow(parts[9]);
            builder.setHigh(parts[10]);
        }
        return builder.build();
    }
}
module.exports = RawOfferCsvParser
