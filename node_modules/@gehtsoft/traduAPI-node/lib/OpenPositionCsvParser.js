'use strict';
let csvParser = require('@gehtsoft/LuaxStdlib-node').csvParser;
let stdlib = require('@gehtsoft/LuaxStdlib-node').stdlib;
let OpenPositionUpdateBuilder = require('./OpenPositionUpdateBuilder.js');
class OpenPositionCsvParser {
    fieldParser;
    constructor() {
        this.fieldParser = new csvParser();
        this.fieldParser.valueSeparator = ";";
    }
    parse(line) {
        let parts, builder, openPositionLine;
        if (line == null) {
            return null;
        }
        openPositionLine = stdlib.trim(line);
        if (openPositionLine == "0" || stdlib.len(openPositionLine) == 0) {
            return null;
        }
        parts = this.fieldParser.splitLine(openPositionLine);
        builder = new OpenPositionUpdateBuilder();
        builder.setTradeID(parts[0]);
        builder.setAccountId(parts[4]);
        builder.setAccountName(parts[5]);
        builder.setAccountKind(parts[21]);
        builder.setOfferId(parts[6]);
        builder.setAmount(parts[13]);
        builder.setBuySell(parts[12]);
        builder.setOpenRate(parts[10]);
        builder.setOpenTime(parts[9]);
        builder.setOpenQuoteId(parts[11]);
        builder.setOpenOrderId(parts[22]);
        builder.setOpenOrderReqId(parts[23]);
        builder.setOpenOrderRequestTXT(parts[24]);
        builder.setCommission(parts[8]);
        builder.setRolloverInterest(parts[7]);
        builder.setTradeIdOrigin(parts[27]);
        builder.setValueDate(parts[28]);
        builder.setParties(parts[32]);
        builder.setDividends(parts[33]);
        return builder.build();
    }
}
module.exports = OpenPositionCsvParser
