'use strict';
let csvParser = require('@gehtsoft/LuaxStdlib-node').csvParser;
let stdlib = require('@gehtsoft/LuaxStdlib-node').stdlib;
let InternalInstrumentDescriptorBuilder = require('./InternalInstrumentDescriptorBuilder.js');
let variantCast = require('@gehtsoft/LuaxStdlib-node').variantCast;
class InstrumentDescriptorCsvParser {
    fieldParser;
    constructor() {
        this.fieldParser = new csvParser();
        this.fieldParser.valueSeparator = ";";
    }
    parse(line) {
        let parts, builder, instrumentLine;
        if (line == null) {
            return null;
        }
        instrumentLine = stdlib.trim(line);
        if (instrumentLine == "0" || stdlib.len(instrumentLine) == 0) {
            return null;
        }
        parts = this.fieldParser.splitLine(instrumentLine);
        builder = new InternalInstrumentDescriptorBuilder();
        builder.setOfferId(parts[0]);
        builder.setSymbol(parts[1]);
        builder.setSortOrder(variantCast.fromString(parts[2]).asInt());
        builder.setPriceStreamId(parts[4]);
        builder.setSubscriptionStatus(parts[5]);
        if (parts.length > 6) {
            builder.setDxFeedSymbol(parts[6]);
        }
        return builder.build();
    }
}
module.exports = InstrumentDescriptorCsvParser
