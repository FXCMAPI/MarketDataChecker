'use strict';
let csvParser = require('@gehtsoft/LuaxStdlib-node').csvParser;
let stdlib = require('@gehtsoft/LuaxStdlib-node').stdlib;
let LeverageProfileBuilder = require('./LeverageProfileBuilder.js');
class LeverageProfileCsvParser {
    fieldParser;
    constructor() {
        this.fieldParser = new csvParser();
        this.fieldParser.valueSeparator = ";";
    }
    parse(line, acctId) {
        let parts, builder, leverageProfileLine;
        if (line == null) {
            return null;
        }
        leverageProfileLine = stdlib.trim(line);
        if (leverageProfileLine == "0" || stdlib.len(leverageProfileLine) == 0) {
            return null;
        }
        parts = this.fieldParser.splitLine(leverageProfileLine);
        builder = new LeverageProfileBuilder();
        builder.setAccountId(acctId);
        builder.setAlpId(parts[0]);
        builder.setOfferId(parts[1]);
        builder.setUsedMargin(parts[2]);
        builder.setUsedMarginAware(parts[3]);
        builder.setUsedMarginEntry(parts[4]);
        builder.setChangeNo(parts[5]);
        builder.setProgressiveMargin(parts[6]);
        builder.setCalcPath(parts[7]);
        if (parts.length > 11) {
            builder.setMarginType(parts[8]);
            builder.setMarginCoeff(parts[9]);
            builder.setMarginAwareCoeff(parts[10]);
            builder.setMarginEntryCoeff(parts[11]);
        }
        return builder.build();
    }
}
module.exports = LeverageProfileCsvParser
