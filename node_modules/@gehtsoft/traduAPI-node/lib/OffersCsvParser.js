'use strict';
let csvParser = require('@gehtsoft/LuaxStdlib-node').csvParser;
let stdlib = require('@gehtsoft/LuaxStdlib-node').stdlib;
let OfferUpdateBuilder = require('./OfferUpdateBuilder.js');
class OffersCsvParser {
    fieldParser;
    constructor() {
        this.fieldParser = new csvParser();
        this.fieldParser.valueSeparator = ";";
    }
    parse(line) {
        let parts, builder, offerLine;
        if (line == null) {
            return null;
        }
        offerLine = stdlib.trim(line);
        if (offerLine == "0" || stdlib.len(offerLine) == 0) {
            return null;
        }
        parts = this.fieldParser.splitLine(offerLine);
        if (parts.length < 18) {
            return null;
        }
        builder = new OfferUpdateBuilder();
        builder.setOfferId(parts[0]);
        builder.setQuoteId(parts[1]);
        builder.setBidTradable(parts[13]);
        builder.setAskTradable(parts[14]);
        builder.setBid(parts[5]);
        builder.setAsk(parts[6]);
        builder.setHigh(parts[15]);
        builder.setLow(parts[16]);
        if (stdlib.len(parts[17]) == 0) {
            builder.setVolume("0");
        }
        else {
            builder.setVolume(parts[17]);
        }
        builder.setTime(parts[4]);
        return builder.build();
    }
}
module.exports = OffersCsvParser
